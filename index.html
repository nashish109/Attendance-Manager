<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attendance Dashboard</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <section id="auth-page" class="auth-page">
    <div class="auth-backdrop-shape shape-one"></div>
    <div class="auth-backdrop-shape shape-two"></div>

    <div class="auth-hero">
      <p class="hero-kicker">Smart Attendance</p>
      <h1>Make attendance feel simple, visual, and student-friendly.</h1>
      <p class="hero-copy">A polished classroom dashboard for teachers and students with instant summaries, day-wise records, and progress tracking.</p>
      <div class="hero-chips">
        <span>Quick Daily Marking</span>
        <span>Per-Student Insights</span>
        <span>Class + Section Ready</span>
      </div>
    </div>

    <div class="auth-card">
      <p id="auth-title" class="auth-title">Welcome Back</p>
      <form id="auth-form" autocomplete="off">
        <label id="auth-name-wrap" class="field hidden" for="auth-name">
          Full Name
          <input id="auth-name" type="text" placeholder="Enter your name" />
        </label>

        <label class="field" for="auth-email">
          Email
          <input id="auth-email" type="email" placeholder="you@example.com" required />
        </label>

        <label class="field" for="auth-password">
          Password
          <input id="auth-password" type="password" placeholder="Enter password" required />
        </label>

        <label class="field" for="auth-role">
          Role
          <select id="auth-role" required>
            <option value="teacher">Teacher</option>
            <option value="student">Student</option>
          </select>
        </label>

        <button id="auth-submit" type="submit" class="primary-btn">Login</button>

        <div class="auth-links">
          <a id="forgot-password-link" href="#" class="auth-link">Forgot password?</a>
          <button id="switch-to-signup-link" type="button" class="auth-link auth-link-btn">New to the website? Sign up</button>
          <button id="switch-to-login-link" type="button" class="auth-link auth-link-btn hidden">Already have an account? Login</button>
        </div>
      </form>

      <p id="auth-message" class="auth-message"></p>
    </div>
  </section>

  <div id="app-shell" class="app-shell hidden">
    <aside class="sidebar">
      <div class="brand">Attendance Dashboard</div>
      <nav class="nav-links">
        <button class="nav-link active" data-page="page-core" type="button">1. Class, Actions, Students, Summary</button>
        <button class="nav-link" data-page="page-records-tracking" type="button">2. Records & Student Tracking</button>
        <button class="nav-link" data-page="page-reports" type="button">3. Reports</button>
        <button class="nav-link" data-page="page-cloud" type="button">4. Cloud Sync</button>
        <button class="nav-link" data-page="page-student-dashboard" type="button">Dashboard</button>
        <button class="nav-link" data-page="page-student-subjects" type="button">Subjects</button>
        <button class="nav-link" data-page="page-student-calculator" type="button">Calculator</button>
        <button class="nav-link" data-page="page-student-profile" type="button">Profile</button>
        <button class="nav-link" data-page="page-teacher-profile" type="button">Teacher Profile</button>
      </nav>
    </aside>

    <main class="workspace">
      <header class="topbar">
        <div class="topbar-left">
          <button id="sidebar-toggle" type="button" class="sidebar-toggle" aria-label="Hide sidebar" aria-pressed="false">
            <span></span>
            <span></span>
            <span></span>
          </button>
          <h2 class="workspace-title">Attendance Workspace</h2>
        </div>
        <div class="topbar-right">
          <div id="user-badge" class="user-badge"></div>
          <button id="logout-btn" type="button" class="secondary-btn">Logout</button>
        </div>
      </header>

      <div class="dashboard-layout">
        <div id="page-core" class="dashboard-page active-page">
          <section id="panel-class" class="panel card panel-class">
            <h3>Class, Section & Subject</h3>
            <form id="class-form" class="row" autocomplete="off">
              <input id="class-name" type="text" placeholder="Class name (e.g., Grade 10)" required data-teacher-only />
              <input id="class-section" type="text" placeholder="Section (e.g., A)" required data-teacher-only />
              <input id="class-subject" type="text" placeholder="Subject (e.g., Mathematics)" required data-teacher-only />
              <button type="submit" data-teacher-only>Add Class</button>
            </form>
            <div class="actions">
              <label class="date-label" for="class-select">Current Class</label>
              <select id="class-select"></select>
              <button id="delete-class" type="button" class="status-absent" data-teacher-only>Delete Class</button>
            </div>
            <p id="class-message" class="action-message"></p>
          </section>

          <section id="panel-actions" class="panel card panel-actions">
            <h3>Actions</h3>
            <div class="actions">
              <label class="date-label" for="attendance-date">Date</label>
              <input id="attendance-date" type="date" data-teacher-only />
              <button id="mark-all-present" type="button" class="status-present" data-teacher-only>Mark All Present</button>
              <button id="mark-all-absent" type="button" class="status-absent" data-teacher-only>Mark All Absent</button>
              <button id="save-record" type="button" data-teacher-only>Save Date Record</button>
            </div>
            <p id="action-message" class="action-message"></p>
          </section>

          <section id="panel-students" class="panel card panel-students">
            <h3>Students</h3>
            <form id="student-form" class="row" autocomplete="off">
              <input id="student-name" type="text" placeholder="Enter student name" required data-teacher-only />
              <button type="submit" data-teacher-only>Add Student</button>
            </form>
            <p id="empty-state">No students added yet.</p>
            <ul id="student-list"></ul>
          </section>

          <section id="panel-summary" class="panel card summary panel-summary">
            <h3>Summary</h3>
            <p>Total Students: <strong id="total">0</strong></p>
            <p>Present: <strong id="present">0</strong></p>
            <p>Absent: <strong id="absent">0</strong></p>
            <p>Attendance: <strong id="percentage">0%</strong></p>
          </section>
        </div>

        <div id="page-records-tracking" class="dashboard-page">
          <section id="panel-records" class="panel card panel-records">
            <h3>Attendance Records</h3>
            <button id="records-dropdown-toggle" type="button" class="secondary-btn records-dropdown-toggle hidden">
              Show Older Records
            </button>
            <p id="record-empty">No date records saved yet.</p>
            <ul id="record-list"></ul>
          </section>

          <section id="panel-tracking" class="panel card panel-tracking">
            <h3>Student Attendance Tracking</h3>
            <p id="individual-empty">No attendance records available yet.</p>
            <div class="table-wrap">
              <table id="individual-table">
                <thead>
                  <tr>
                    <th>Student</th>
                    <th>Present Days</th>
                    <th>Absent Days</th>
                    <th>Total Days</th>
                    <th>Attendance %</th>
                  </tr>
                </thead>
                <tbody id="individual-body"></tbody>
              </table>
            </div>
          </section>
        </div>

        <div id="page-reports" class="dashboard-page">
          <section id="panel-reports" class="panel card panel-reports">
            <h3>Reports</h3>
            <div class="actions">
              <label class="date-label" for="report-start">Start</label>
              <input id="report-start" type="date" />
              <label class="date-label" for="report-end">End</label>
              <input id="report-end" type="date" />
              <label class="date-label" for="report-days">Or Last N Days</label>
              <input id="report-days" type="number" min="1" step="1" placeholder="e.g., 7" />
            </div>
            <div class="actions">
              <button id="export-range-csv" type="button">Export Report CSV</button>
              <button id="export-student-csv" type="button" class="secondary-btn">Export Full Student Summary</button>
            </div>
            <p id="report-message" class="action-message"></p>
          </section>
        </div>

        <div id="page-cloud" class="dashboard-page">
          <section id="panel-cloud" class="panel card panel-cloud">
            <h3>Cloud Sync (Supabase)</h3>
            <div class="row">
              <input id="cloud-url" type="url" placeholder="Supabase URL (https://xxxx.supabase.co)" />
              <input id="cloud-key" type="password" placeholder="Supabase anon key" />
            </div>
            <div class="actions">
              <button id="save-cloud-config" type="button">Connect Cloud</button>
              <button id="upload-cloud" type="button">Upload Local to Cloud</button>
              <button id="download-cloud" type="button" class="secondary-btn">Download Cloud to Local</button>
              <button id="clear-cloud-config" type="button" class="secondary-btn">Disconnect</button>
            </div>
            <p id="cloud-status" class="action-message"></p>
          </section>
        </div>

        <div id="page-student-dashboard" class="dashboard-page">
          <section class="panel card panel-student-dashboard">
            <h3>Academic Attendance Overview</h3>
            <div class="student-kpis">
              <div class="kpi-card">
                <p>Overall Attendance Percentage</p>
                <strong id="student-overall-percentage">0%</strong>
              </div>
              <div class="kpi-card">
                <p>Total Classes Conducted</p>
                <strong id="student-total-classes">0</strong>
              </div>
              <div class="kpi-card">
                <p>Total Classes Attended</p>
                <strong id="student-attended-classes">0</strong>
              </div>
              <div class="kpi-card">
                <p>Required Minimum</p>
                <strong id="student-required-percentage">75%</strong>
              </div>
              <div class="kpi-card">
                <p>Compliance Status</p>
                <strong id="student-compliance-status">Compliant</strong>
              </div>
            </div>

            <h4 class="subsection-title">Subject Performance Analytics</h4>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>Subject Name</th>
                    <th>Total Classes</th>
                    <th>Attended Classes</th>
                    <th>Attendance %</th>
                    <th>Deviation from Threshold</th>
                    <th>Risk Level</th>
                    <th>Classes Required to Regain Compliance</th>
                  </tr>
                </thead>
                <tbody id="dashboard-subject-body"></tbody>
              </table>
              <p id="dashboard-subject-empty">No teacher-linked subject attendance found.</p>
            </div>

            <h4 class="subsection-title">Attendance Trend Analysis</h4>
            <div class="trend-card">
              <svg id="attendance-trend-chart" viewBox="0 0 800 220" role="img" aria-label="Attendance trend chart"></svg>
              <p id="trend-empty" class="action-message hidden">Not enough date-wise records to build trend.</p>
            </div>

            <h4 class="subsection-title">Compliance Projection</h4>
            <div class="student-kpis projection-kpis">
              <div class="kpi-card">
                <p>Projected % (Next Subject Cycle)</p>
                <strong id="projection-percentage">0%</strong>
              </div>
              <div class="kpi-card">
                <p>Maximum Allowable Absences</p>
                <strong id="projection-allowable-absences">0</strong>
              </div>
              <div class="kpi-card">
                <p>Consecutive Classes to Regain Compliance</p>
                <strong id="projection-required-classes">0</strong>
              </div>
            </div>

            <h4 class="subsection-title">Risk & Alert Summary</h4>
            <div id="student-alerts" class="alerts-list"></div>
          </section>
        </div>

        <div id="page-student-subjects" class="dashboard-page">
          <section class="panel card panel-student-subjects">
            <h3>Subject-wise Attendance</h3>
            <p class="action-message">Subjects are synced from teacher records. Students cannot add subjects.</p>
            <p id="subject-message" class="action-message"></p>
            <div class="table-wrap">
              <table id="subject-table">
                <thead>
                  <tr>
                    <th>Subject</th>
                    <th>Class</th>
                    <th>Section</th>
                    <th>Assigned Teacher</th>
                    <th>Total Classes</th>
                    <th>Attended Classes</th>
                    <th>Attendance %</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody id="subject-body"></tbody>
              </table>
            </div>
            <p id="subject-empty">No subjects added yet.</p>
          </section>
        </div>

        <div id="page-student-calculator" class="dashboard-page">
          <section class="panel card panel-student-calculator">
            <h3>Attendance Calculator</h3>
            <div class="row">
              <input id="calc-total-classes" type="number" min="0" step="1" placeholder="Total classes" />
              <input id="calc-attended-classes" type="number" min="0" step="1" placeholder="Attended classes" />
              <input id="calc-target-percentage" type="number" min="1" max="100" step="0.1" placeholder="Target %" />
            </div>
            <div class="student-kpis">
              <div class="kpi-card">
                <p>Current Attendance</p>
                <strong id="calc-current-percentage">0%</strong>
              </div>
              <div class="kpi-card">
                <p>Target Attendance</p>
                <strong id="calc-target-display">75%</strong>
              </div>
            </div>
            <p id="calc-result" class="action-message"></p>
          </section>
        </div>

        <div id="page-student-profile" class="dashboard-page">
          <section class="panel card panel-student-profile">
            <h3>Student Profile</h3>
            <form id="profile-form" class="profile-grid" autocomplete="off">
              <label class="field" for="profile-name">
                Name
                <input id="profile-name" type="text" required />
              </label>
              <label class="field" for="profile-roll">
                Roll Number
                <input id="profile-roll" type="text" />
              </label>
              <label class="field" for="profile-department">
                Class
                <input id="profile-department" type="text" />
              </label>
              <label class="field" for="profile-semester">
                Section
                <input id="profile-semester" type="text" />
              </label>
              <label class="field" for="profile-target">
                Target Attendance %
                <input id="profile-target" type="number" min="1" max="100" step="0.1" required />
              </label>
              <div class="actions">
                <button id="profile-edit-btn" type="button" class="secondary-btn">Edit Profile</button>
                <button id="profile-save-btn" type="submit">Save Profile</button>
                <button id="profile-logout-btn" type="button" class="secondary-btn">Logout</button>
              </div>
            </form>
            <p id="profile-message" class="action-message"></p>
          </section>
        </div>

        <div id="page-teacher-profile" class="dashboard-page">
          <section class="panel card panel-teacher-profile">
            <h3>Teacher Profile</h3>
            <form id="teacher-profile-form" class="profile-grid" autocomplete="off">
              <label class="field" for="teacher-profile-name">
                Name
                <input id="teacher-profile-name" type="text" required />
              </label>
              <label class="field" for="teacher-profile-id">
                Teacher ID
                <input id="teacher-profile-id" type="text" />
              </label>
              <label class="field" for="teacher-profile-department">
                Department
                <input id="teacher-profile-department" type="text" />
              </label>
              <label class="field" for="teacher-profile-subject">
                Primary Subject
                <input id="teacher-profile-subject" type="text" />
              </label>
              <div class="actions">
                <button id="teacher-profile-edit-btn" type="button" class="secondary-btn">Edit Profile</button>
                <button id="teacher-profile-save-btn" type="submit">Save Profile</button>
                <button id="teacher-profile-logout-btn" type="button" class="secondary-btn">Logout</button>
              </div>
            </form>
            <p id="teacher-profile-message" class="action-message"></p>
          </section>
        </div>
      </div>
    </main>
  </div>

  <script type="module" src="script.js"></script>
</body>
</html>
